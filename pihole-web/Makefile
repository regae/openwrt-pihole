include $(TOPDIR)/rules.mk

PKG_NAME:=pihole-web
PKG_RELEASE:=1

PKG_SOURCE_PROTO:=git
PKG_SOURCE_URL:=https://github.com/pi-hole/web
PKG_SOURCE_VERSION:=5b6c8bbf41aa80eb43c0022245f20dc755c5e240
PKG_MIRROR_HASH:=5016bfb0ff37f1fbc8762e1e2b5866287bbb20cf89de4ee6432fef28d3aa4815
PKG_VERSION:=6.0-$(call version_abbrev,$(PKG_SOURCE_VERSION))

PKG_LICENSE:=EUPL
PKG_LICENSE_FILES:=LICENSE

include $(INCLUDE_DIR)/package.mk
define Package/pihole-web
  SECTION:=net
  CATEGORY:=Network
  TITLE:=Pi-hole Dashboard for stats and more
  URL:=https://pi-hole.net/
  DEPENDS:=pihole
endef

define Package/pihole-web/description
  Pi-hole®'s Web interface (based off of AdminLTE) provides a central location to manage your Pi-hole and review the statistics generated by FTLDNS™.
endef

define Build/Compile
endef

define Package/pihole-web/install
	$(INSTALL_DIR) $(1)/usr/lib/pihole/admin
	$(CP) -r $(PKG_BUILD_DIR)/{img,scripts,style,*.lp} $(1)/usr/lib/pihole/admin
endef

define Package/pihole-web/postinst
#!/bin/sh
# check if we are on real system
if [ -z "$${IPKG_INSTROOT}" ]; then
	sed -i '/doc_root/ s/^;*/;/' /etc/php.ini
fi
exit 0
endef

override CONFIG_AUTOREMOVE=

$(eval $(call BuildPackage,pihole-web))
